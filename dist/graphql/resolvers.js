"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _index = _interopRequireDefault(require("../firebase/index.js"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _default = {
  Query: {
    getAllFilms: () => {
      let data;

      const getData = async () => {
        await _index.default.ref().child("films").get().then(s => {
          if (s.exists()) {
            data = s.val();
          }
        }).catch(error => {
          console.error(error);
        });
      };

      return getData().then(() => data);
    },
    getAllPersons: () => {
      let data;

      const getData = async () => {
        await _index.default.ref().child("persons").get().then(s => {
          if (s.exists()) {
            data = s.val();
          }
        }).catch(error => {
          console.error(error);
        });
      };

      return getData().then(() => data);
    },
    getProducers: () => {
      let data;

      const getData = async () => {
        await _index.default.ref().child("persons").get().then(s => {
          if (s.exists()) {
            data = s.val();
          }
        }).catch(error => {
          console.error(error);
        });
      };

      return getData().then(() => {
        return data.filter(p => {
          return p.type === "producer";
        });
      });
    },
    getActers: () => {
      let data;

      const getData = async () => {
        await _index.default.ref().child("persons").get().then(s => {
          if (s.exists()) {
            data = s.val();
          }
        }).catch(error => {
          console.error(error);
        });
      };

      return getData().then(() => {
        return data.filter(p => {
          return p.type === "acter";
        });
      });
    },
    getPerson: (_, params) => {
      let data;

      const getData = async () => {
        await _index.default.ref().child(`/persons/${params.id}`).get().then(s => {
          if (s.exists()) {
            data = s.val();
          }
        }).catch(error => {
          console.error(error);
        });
      };

      return getData().then(() => data);
    },
    getFilm: (_, params) => {
      let data;

      const getData = async () => {
        await _index.default.ref().child(`/films/${params.id}`).get().then(s => {
          if (s.exists()) {
            data = s.val();
          }
        }).catch(error => {
          console.error(error);
        });
      };

      return getData().then(() => data);
    },
    getAllTimes: () => {
      let data;

      const getData = async () => {
        await _index.default.ref().child("times").get().then(s => {
          if (s.exists()) {
            data = s.val();
          }
        }).catch(error => {
          console.error(error);
        });
      };

      return getData().then(() => data);
    },
    getTime: (_, params) => {
      let data;

      const getData = async () => {
        await _index.default.ref().child("times").get().then(s => {
          if (s.exists()) {
            data = s.val();
          }
        }).catch(error => {
          console.error(error);
        });
      };

      return getData().then(() => {
        return data.find(({
          id
        }) => {
          return id === params.id;
        });
      });
    }
  }
};
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9ncmFwaHFsL3Jlc29sdmVycy5qcyJdLCJuYW1lcyI6WyJRdWVyeSIsImdldEFsbEZpbG1zIiwiZGF0YSIsImdldERhdGEiLCJkYXRhYmFzZSIsInJlZiIsImNoaWxkIiwiZ2V0IiwidGhlbiIsInMiLCJleGlzdHMiLCJ2YWwiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImdldEFsbFBlcnNvbnMiLCJnZXRQcm9kdWNlcnMiLCJmaWx0ZXIiLCJwIiwidHlwZSIsImdldEFjdGVycyIsImdldFBlcnNvbiIsIl8iLCJwYXJhbXMiLCJpZCIsImdldEZpbG0iLCJnZXRBbGxUaW1lcyIsImdldFRpbWUiLCJmaW5kIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7ZUFFZTtBQUNYQSxFQUFBQSxLQUFLLEVBQUU7QUFDSEMsSUFBQUEsV0FBVyxFQUFFLE1BQU07QUFDZixVQUFJQyxJQUFKOztBQUNBLFlBQU1DLE9BQU8sR0FBRyxZQUFZO0FBQ3hCLGNBQU1DLGVBQVNDLEdBQVQsR0FBZUMsS0FBZixDQUFxQixPQUFyQixFQUE4QkMsR0FBOUIsR0FDTEMsSUFESyxDQUNDQyxDQUFELElBQU87QUFBRSxjQUFLQSxDQUFDLENBQUNDLE1BQUYsRUFBTCxFQUFrQjtBQUFFUixZQUFBQSxJQUFJLEdBQUdPLENBQUMsQ0FBQ0UsR0FBRixFQUFQO0FBQWdCO0FBQUMsU0FEOUMsRUFFTEMsS0FGSyxDQUVFQyxLQUFELElBQVc7QUFBRUMsVUFBQUEsT0FBTyxDQUFDRCxLQUFSLENBQWNBLEtBQWQ7QUFBc0IsU0FGcEMsQ0FBTjtBQUdILE9BSkQ7O0FBTUEsYUFBT1YsT0FBTyxHQUFHSyxJQUFWLENBQWdCLE1BQU1OLElBQXRCLENBQVA7QUFDSCxLQVZFO0FBWUhhLElBQUFBLGFBQWEsRUFBRSxNQUFNO0FBQ2pCLFVBQUliLElBQUo7O0FBQ0EsWUFBTUMsT0FBTyxHQUFHLFlBQVk7QUFDeEIsY0FBTUMsZUFBU0MsR0FBVCxHQUNMQyxLQURLLENBQ0MsU0FE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QUFJckIsSUFBSjs7QUFDQSxZQUFNQyxPQUFPLEdBQUcsWUFBWTtBQUN4QixjQUFNQyxlQUFTQyxHQUFULEdBQ0xDLEtBREssQ0FDQyxPQURELEVBQ1VDLEdBRFYsR0FFTEMsSUFGSyxDQUVDQyxDQUFELElBQU87QUFBRSxjQUFJQSxDQUFDLENBQUNDLE1BQUYsRUFBSixFQUFnQjtBQUFFUixZQUFBQSxJQUFJLEdBQUdPLENBQUMsQ0FBQ0UsR0FBRixFQUFQO0FBQWdCO0FBQUMsU0FGNUMsRUFHTEMsS0FISyxDQUdFQyxLQUFELElBQVc7QUFBRUMsVUFBQUEsT0FBTyxDQUFDRCxLQUFSLENBQWNBLEtBQWQ7QUFBc0IsU0FIcEMsQ0FBTjtBQUlILE9BTEQ7O0FBT0EsYUFBT1YsT0FBTyxHQUFHSyxJQUFWLENBQWUsTUFBTTtBQUN4QixlQUFPTixJQUFJLENBQUMwQixJQUFMLENBQVcsQ0FBQztBQUFFSixVQUFBQTtBQUFGLFNBQUQsS0FBWTtBQUFFLGlCQUFPQSxFQUFFLEtBQUtELE1BQU0sQ0FBQ0MsRUFBckI7QUFBeUIsU0FBbEQsQ0FBUDtBQUNILE9BRk0sQ0FBUDtBQUdIO0FBcEdFO0FBREksQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkYXRhYmFzZSBmcm9tIFwiLi4vZmlyZWJhc2UvaW5kZXguanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHtcclxuICAgIFF1ZXJ5OiB7XHJcbiAgICAgICAgZ2V0QWxsRmlsbXM6ICgpID0+IHtcclxuICAgICAgICAgICAgbGV0IGRhdGE7XHJcbiAgICAgICAgICAgIGNvbnN0IGdldERhdGEgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBkYXRhYmFzZS5yZWYoKS5jaGlsZChcImZpbG1zXCIpLmdldCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbigocykgPT4geyBpZiAoIHMuZXhpc3RzKCkgKSB7IGRhdGEgPSBzLnZhbCgpIH19KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4geyBjb25zb2xlLmVycm9yKGVycm9yKSB9KTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBnZXREYXRhKCkudGhlbiggKCkgPT4gZGF0YSApO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBnZXRBbGxQZXJzb25zOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBkYXRhO1xyXG4gICAgICAgICAgICBjb25zdCBnZXREYXRhID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgZGF0YWJhc2UucmVmKClcclxuICAgICAgICAgICAgICAgIC5jaGlsZChcInBlcnNvbnNcIikuZ2V0KClcclxuICAgICAgICAgICAgICAgIC50aGVuKChzKSA9PiB7IGlmICggcy5leGlzdHMoKSApIHsgZGF0YSA9IHMudmFsKCkgfX0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7IGNvbnNvbGUuZXJyb3IoZXJyb3IpIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGdldERhdGEoKS50aGVuKCAoKSA9PiBkYXRhICk7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIGdldFByb2R1Y2VyczogKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZGF0YTtcclxuICAgICAgICAgICAgY29uc3QgZ2V0RGF0YSA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGRhdGFiYXNlLnJlZigpXHJcbiAgICAgICAgICAgICAgICAuY2hpbGQoXCJwZXJzb25zXCIpLmdldCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbigocykgPT4geyBpZiAoIHMuZXhpc3RzKCkgKSB7IGRhdGEgPSBzLnZhbCgpIH19KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4geyBjb25zb2xlLmVycm9yKGVycm9yKSB9KTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBnZXREYXRhKCkudGhlbigoKSA9PiB7IFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuZmlsdGVyKChwKSA9PiB7IHJldHVybiBwLnR5cGUgPT09IFwicHJvZHVjZXJcIiB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIGdldEFjdGVyczogKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZGF0YTtcclxuICAgICAgICAgICAgY29uc3QgZ2V0RGF0YSA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGRhdGFiYXNlLnJlZigpXHJcbiAgICAgICAgICAgICAgICAuY2hpbGQoXCJwZXJzb25zXCIpLmdldCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbigocykgPT4geyBpZiAocy5leGlzdHMoKSkgeyBkYXRhID0gcy52YWwoKSB9fSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsgY29uc29sZS5lcnJvcihlcnJvcikgfSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZ2V0RGF0YSgpLnRoZW4oKCkgPT4geyBcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmZpbHRlcigocCkgPT4geyByZXR1cm4gcC50eXBlID09PSBcImFjdGVyXCIgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICBnZXRQZXJzb246ICggXywgcGFyYW1zICkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZGF0YTtcclxuICAgICAgICAgICAgY29uc3QgZ2V0RGF0YSA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGRhdGFiYXNlLnJlZigpXHJcbiAgICAgICAgICAgICAgICAuY2hpbGQoYC9wZXJzb25zLyR7cGFyYW1zLmlkfWApLmdldCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbigocykgPT4geyBpZiAocy5leGlzdHMoKSkgeyBkYXRhID0gcy52YWwoKSB9fSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsgY29uc29sZS5lcnJvcihlcnJvcikgfSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZ2V0RGF0YSgpLnRoZW4oKCkgPT4gZGF0YSk7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIGdldEZpbG06ICggXywgcGFyYW1zICkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZGF0YTtcclxuICAgICAgICAgICAgY29uc3QgZ2V0RGF0YSA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGRhdGFiYXNlLnJlZigpXHJcbiAgICAgICAgICAgICAgICAuY2hpbGQoYC9maWxtcy8ke3BhcmFtcy5pZH1gKS5nZXQoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKHMpID0+IHsgaWYgKHMuZXhpc3RzKCkpIHsgZGF0YSA9IHMudmFsKCkgfX0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7IGNvbnNvbGUuZXJyb3IoZXJyb3IpIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGdldERhdGEoKS50aGVuKCAoKSA9PiBkYXRhICk7XHJcbiAgICAgICAgfSxcclxuICAgIFxyXG4gICAgICAgIGdldEFsbFRpbWVzOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBkYXRhO1xyXG4gICAgICAgICAgICBjb25zdCBnZXREYXRhID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgZGF0YWJhc2UucmVmKClcclxuICAgICAgICAgICAgICAgIC5jaGlsZChcInRpbWVzXCIpLmdldCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbigocykgPT4geyBpZiAocy5leGlzdHMoKSkgeyBkYXRhID0gcy52YWwoKSB9fSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsgY29uc29sZS5lcnJvcihlcnJvcikgfSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZ2V0RGF0YSgpLnRoZW4oICgpID0+IGRhdGEgKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIFxyXG4gICAgICAgIGdldFRpbWU6ICggXywgcGFyYW1zICkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZGF0YTtcclxuICAgICAgICAgICAgY29uc3QgZ2V0RGF0YSA9IGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGRhdGFiYXNlLnJlZigpXHJcbiAgICAgICAgICAgICAgICAuY2hpbGQoXCJ0aW1lc1wiKS5nZXQoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oKHMpID0+IHsgaWYgKHMuZXhpc3RzKCkpIHsgZGF0YSA9IHMudmFsKCkgfX0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7IGNvbnNvbGUuZXJyb3IoZXJyb3IpIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGdldERhdGEoKS50aGVuKCgpID0+IHsgXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YS5maW5kKCAoeyBpZCB9KSA9PiB7IHJldHVybiBpZCA9PT0gcGFyYW1zLmlkIH0pIDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBcclxufSJdfQ==